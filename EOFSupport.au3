#cs ----------------------------------------------------------------------------

 AutoIt Version: 3.3.8.1
 Author: Naker90

 Script Function:
	EOF Support!

 Testeado con Bifrost

#ce ----------------------------------------------------------------------------

Func _WriteEOF($sFilePath, $sEOF)

	If not FileExists($sFilePath) then
		MsgBox(16, 'ERROR', 'No se encuentra el archivo')
		Return ''
	EndIf

	Local $sFileOpen = FileOpen($sFilePath, 17)
	Local $sRead = FileRead($sFileOpen)

	FileWrite($sFileOpen, $sRead)
	FileWrite($sFileOpen, $sEOF)

	FileClose($sFileOpen)

EndFunc

Func _ReadEOF($sFilePath)

	If not FileExists($sFilePath) then
		MsgBox(16, 'ERROR', 'No se encuentra el archivo')
		Return ''
	EndIf

	Local $sRead = FileRead($sFilePath)

	Local $sReverse = _Reverse($sRead)

	Local $sPosition = StringInStr($sReverse, '0x000000000000000000000000000000', 1)
	Local $sEOF = StringMid($sReverse, 1, $sPosition - 1)

	Return _Reverse($sEOF)

EndFunc

Func _Reverse($sString)

	Local $sReturn, $sI = StringLen($sString)
	Do
		$sReturn &= StringMid($sString, $sI, 1)
		$sI -= 1
	Until $sI = 0

	Return $sReturn

EndFunc
